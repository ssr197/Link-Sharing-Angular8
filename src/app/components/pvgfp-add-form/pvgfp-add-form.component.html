<div class="row">
    <div id="rx-fp-middle" class="col-md-8">
        <nav>
            <div class="nav nav-tabs nav-fill" role="tablist ">
                <a class="nav-item nav-link active" [ngClass]="{'active':activePage==='uploadForm'}" data-toggle="tab" role="tab" (click)="switchForm('uploadForm')">Upload Form</a>
                <a class="nav-item nav-link" [ngClass]="{'active':activePage==='formSummary'}" data-toggle="tab"  role="tab"(click)="switchForm('formSummary')">Form Summary</a> 
            </div>
        </nav>
        <div class="tab-content" id="nav-formPage">
            <div class="tab-pane fade show active " [ngClass]="{'active':activePage==='uploadForm'}">
                <app-pvgfp-upload-form (showAnnotationList)="annotationList.createAnnotation($event)" (openGetDataStringCall)="callDataStringApi($event)" (getCurrPageAnnotations)="getCurrPageAnnotations($event)"></app-pvgfp-upload-form>
            </div>
            <div class="tab-pane fade show active " [ngClass]="{'active':activePage==='formSummary'}">
                <app-pvgfp-form-summary></app-pvgfp-form-summary>
            </div>
        </div>
    </div>
    <div id="rx-fp-right" class="col-md-4 pull-right p-l-0">
        <div class="card m-b-10">
            <div class="card-body pv-sec-heading">
                <app-pvgfp-group-list #groupList [formId]="formId" (groupId)="updateGroupId($event)" [showBtn]="true" (currGroupData)="updateCurrentGroupJSON($event)" (maxElementId)="updateMaxElementId($event)" (maxAnnotId)="updateMaxAnnotId($event)"></app-pvgfp-group-list>
            </div>
        </div>
        <div class="card ">
            <div class="card-header pv-sec-heading ">
                <span class="rxmain-container-header-label rx-widget-title ">Annotations Properties </span>
            </div>
            <div class="card-body ">
                <div class="pvfpContainer">
                    <!--Tab for annotList, dstring box & element list-->
                    <section id="tabs1 " class="card ">
                        <div class="row ">
                            <div class="col-xs-12 col-md-12 col-sm-12 nav-tabs-box">
                                <nav>
                                    <div class="nav nav-tabs nav-fill " id="nav-tab2 " role="tablist ">
                                        <a class="nav-item nav-link active" id="nav-annotations-tab" [ngClass]="{'active':activeTab==='nav-annotations'}" data-toggle="tab" role="tab" (click)="switchAnotherTab('nav-annotations')">Annotations <span class="badge badge-dark circle square-20" *ngIf="currGroupJSON && currGroupJSON.annotations && currGroupJSON.annotations.length">{{currGroupJSON.annotations.length}}</span></a>
                                        <a class="nav-item nav-link" id="nav-datastringbox-tab" [ngClass]="{'active':activeTab==='nav-datastringbox'}" data-toggle="tab"  role="tab"(click)="switchAnotherTab('nav-datastringbox')" >String</a>
                                        <a class="nav-item nav-link" id="nav-elementlist-tab" [ngClass]="{'show active':activeTab==='nav-elementlist'}" data-toggle="tab" role="tab" (click)="switchAnotherTab('nav-elementlist')">Elements <span class="badge badge-dark circle square-20" *ngIf="currentAnnotationData && currentAnnotationData.datastring.elements && currentAnnotationData.datastring.elements.length">{{currentAnnotationData.datastring.elements.length}}</span></a> 
                                    </div>
                                </nav>
                                <div class="tab-content" id="nav-tabContent2">
                                    <div class="tab-pane fade show active "[ngClass]="{'active':activeTab==='nav-annotations'}" id="nav-annotations">
                                        <app-pvgfp-annotation-list #annotationList [formId]="formId" [groupId]="groupId" (populateDataString)="populateDataString($event)" (coordinateArray)="coordinateArray($event)" (currAnnnotData)="currentAnnotData($event)"
                                            (updateCurrGroupJson)="updateCurrentGroupJSON($event)" [maxAnnotId]="maxAnnotId" (newAnnotId)="updateMaxAnnotId($event)" (createMarker)="updateCoordinateList($event)" (removeMarker)="removeMarker($event)" (createVirtualAnnot)="addVirtualAnnot($event)"></app-pvgfp-annotation-list>
                                            <div class="text-center" *ngIf="!currGroupJSON || !currGroupJSON.annotations || !currGroupJSON.annotations.length">No annotation available...<br/></div>
                                    </div>
                                    <div class="tab-pane fade show" [ngClass]="{'active':activeTab==='nav-datastringbox'}" id="nav-datastringbox">
                                        <div class="line-loader " [hidden]="!lineLoader "></div>
                                        <textarea rows="5 " #textbox [(ngModel)]="currDataString " class="form-control " (select)="getSelectedText()"></textarea>
                                    </div>
                                    <div class="tab-pane fade show" [ngClass]="{'active':activeTab==='nav-elementlist'}" id="nav-elementlist">
                                        <app-pvgfp-element-list [formId]="formId" [groupId]="groupId" [currGroupJSON]="currGroupJSON" [currentAnnotationData]="currentAnnotationData" (currElementJson)="[element.updateCurrElement($event), openForm('nav-dElements')]" (deleteVirtualElement)="deleteVirtualAnnot($event)" (updatedGroupJson)="updateCurrentGroupJSON($event)"></app-pvgfp-element-list>
                                        <div class="text-center" *ngIf="!currentAnnotationData || !currentAnnotationData.datastring.elements || !currentAnnotationData.datastring.elements.length">No element available... <br/> <button class="badge badge-primary btn" type="button" (click)="addNextElement()"><i class="md md-plus"></i> Add New Element</button></div>
                                        <button class="badge badge-primary btn" *ngIf="currentAnnotationData && currentAnnotationData.datastring.elements && currentAnnotationData.datastring.elements.length" type="button" (click)="addNextElement()"><i class="md md-plus"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section class="card" *ngIf="matrixCoords">
                      <app-pvgfp-matrix-coordinates *ngIf="matrixCoords.length" [coordinateList]="matrixCoords"></app-pvgfp-matrix-coordinates>
                    </section>

                    <!--Tab for Add Data String & Add element-->
                    <section id="tabs2 " class="card ">
                        <div class="row ">
                            <div class="col-xs-12 col-md-12 col-sm-12 nav-tabs-box">
                                <nav>
                                    <div class="nav nav-tabs nav-fill" id="nav-tab " role="tablist ">
                                        <a class="nav-item nav-link active" id="nav-dstring-tab" [ngClass]="{'active':activeForm==='nav-dString'}" data-toggle="tab" role="tab" (click)="openForm('nav-dString')">Data String</a>
                                        <a class="nav-item nav-link" id="nav-delements-tab" [ngClass]="{'active':activeForm==='nav-dElements'}" data-toggle="tab" role="tab" (click)="openForm('nav-dElements')">Data Element</a>
                                    </div>
                                </nav>
                                <div class="tab-content" id="nav-tabContent ">
                                    <div class="tab-pane fade show active" [ngClass]="{'active':activeForm==='nav-dString'}" id="nav-dString">
                                        <app-pvgfp-group-data-string #dataString [formId]="formId" [currGroupId]="groupId" [currGroupJSON]="currGroupJSON" (currValuemapId)="updateValuemapId($event)" [currAnnotId]="currentAnnnotationId " [valueMaps]="valuemapIds" [keyValueMap]="keyValueMap" [currentAnnotationData]="currentAnnotationData"></app-pvgfp-group-data-string>
                                    </div>
                                    <div class="tab-pane fade show" [ngClass]="{'active':activeForm==='nav-dElements'}" id="nav-dElements">
                                        <app-pvgfp-group-data-elements #element [formId]="formId " [currGroupId]="groupId " [currAnnotId]="currentAnnnotationId " (maxElemId)="updateMaxElementId($event)" [maxElementId]="maxElementId" (openElementListTab)="switchAnotherTab('nav-elementlist')" [matchingParentElementList]="matchingParentList" [secondaryAssociation]="secondaryAssociation" (sendBackMatchingParent)="updateMatchingParentList($event)" (sendBackSecoundaryAssociations)="updateSecondaryAssociation($event)" (createVirtualAnnot)="createVirtualAnnot($event)" [maxAnnotId]="maxAnnotId" [currGroupJSON]="currGroupJSON" (deleteVirtualAnnotation)="deleteVirtualAnnot($event)"></app-pvgfp-group-data-elements>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <div class="row ">
                        <div class="col-sm-12 m-t-5 m-b-10 ">
                            <span class="col-sm-12 ">
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<app-pvgfp-group-operations *ngIf="openGroupOperatemodal" [openmodal]="openGroupOperatemodal"  [modalType]="modalType" [formId]="formId" [currentGroup]="currGroupJSON" (addGroup)="groupList.addGroup()" (updatedGroupJson)="updateCurrentGroupJSON($event)"></app-pvgfp-group-operations>
<app-modal-keymap *ngIf="openKeymapModal" [openmodal]="openKeymapModal" [modalType]="modalType" [elementEntityListArray]="elementEntityListArray" [valueMaps]="valuemapIds" [formId]="formId" [annotId]="currentAnnnotationId" [groupId]="groupId" [valuemapid]="currentValuemapId" [keyValueMap]="keyValueMap" (keyValueMapEmit)="updateKeyValueMap($event)"></app-modal-keymap>
<app-pvgfp-matching-parent-element *ngIf="isOpenMatchinParent" [openmodal]="isOpenMatchinParent" [modalType]="modalType" (matchingParentList)="updateMatchingParentList($event)" [elementEntityListArray]="elementEntityListArray" [matchingParentElemData]="matchingParentList"></app-pvgfp-matching-parent-element>
<app-secondary-association *ngIf="isOpenSecondarymodal" [openmodal]="isOpenSecondarymodal" [modalType]="modalType" (secondaryAssociation)="updateSecondaryAssociation($event)" [elementEntityListArray]="elementEntityListArray" [secondaryAssociationsData]="secondaryAssociation"></app-secondary-association>
